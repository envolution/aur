# Maintainer: Sven-Hendrik Haase <svenstaro@archlinux.org>
# Contributor: bartus <arch-user-repoá˜“bartus.33mail.com>
pkgname=geogram
pkgver=1.8.8
pkgrel=3
pkgdesc="Library of geometric algorithms"
arch=('x86_64')
url="https://github.com/BrunoLevy/geogram"
license=('BSD')
depends=('glu' 'glfw-x11')
makedepends=('cmake' 'ninja')
source=(
  "git+https://github.com/BrunoLevy/geogram.git" 
  "git+https://github.com/ocornut/imgui.git#docking" 
  cmake_minver.patch 
  cmake_doc_minver.patch
)
sha256sums=('SKIP'
            'SKIP'
            '6c665a46e750ff724180adf6e2f978a31fbc535b51983d0b46efed035fefb626'
            '7951de88bcbe3576d7c969cf453b54d0ec6cd5cf604079015a63114d44fc567a')

prepare() {
  cd $pkgname
  git submodule init
  git config submodule.libs
  patch -p0 -i ../cmake_minver.patch
  patch -p0 -i ../cmake_doc_minver.patch
}
build() {
  cd ${pkgname}

  CFLAGS+=" -Wno-incompatible-pointer-types" \
  cmake \
    -Bbuild \
    -GNinja \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_BUILD_TYPE=None \
    -DGEOGRAM_USE_SYSTEM_GLFW3=ON

  ninja -C build
}

package() {
  cd ${pkgname}

  DESTDIR=${pkgdir} ninja -C build install
  install -Dm755 LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
}

